!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).compromiseNumbers=t()}(this,(function(){"use strict";function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var r="twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety|fourty",i=function(e,t){var n=e.match("#Value+");if(n.has("#NumericValue #NumericValue")&&(n.has("#Value @hasComma #Value")?n.splitAfter("@hasComma"):n=n.splitAfter("#NumericValue")),n.has("#Value #Value #Value")&&!n.has("#Multiple")&&n.has("("+r+") #Cardinal #Cardinal")&&(n=n.splitAfter("("+r+") #Cardinal")),n.has("#Value #Value")){n.has("#NumericValue #NumericValue")&&(n=n.splitOn("#Year")),n.has("("+r+") (eleven|twelve|thirteen|fourteen|fifteen|sixteen|seventeen|eighteen|nineteen)")&&(n=n.splitAfter("("+r+")"));var i=n.match("#Cardinal #Cardinal");i.found&&!n.has("(point|decimal)")&&(i.has("#Cardinal (#Multiple|point|decimal)")||i.has("("+r+") #Cardinal")||i.has("#Multiple #Value")||i.terms().forEach((function(e){n=n.splitOn(e)}))),n.match("#Ordinal #Ordinal").match("#TextValue").found&&!n.has("#Multiple")&&(n.has("("+r+") #Ordinal")||(n=n.splitAfter("#Ordinal"))),n.has("#Ordinal #Cardinal")&&(n=n.splitBefore("#Cardinal+")),n.has("#TextValue #NumericValue")&&!n.has("("+r+"|#Multiple)")&&(n=n.splitBefore("#NumericValue+"))}return n.has("#NumberRange")&&(n=n.splitAfter("#NumberRange")),"number"==typeof t&&(n=n.get(t)),n},u=function(e){for(var t=[{reg:/^(minus|negative)[\s\-]/i,mult:-1},{reg:/^(a\s)?half[\s\-](of\s)?/i,mult:.5}],n=0;n<t.length;n++)if(!0===t[n].reg.test(e))return{amount:t[n].mult,str:e.replace(t[n].reg,"")};return{amount:1,str:e}},a={ones:{zeroth:0,first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9},teens:{tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19},tens:{twentieth:20,thirtieth:30,fortieth:40,fourtieth:40,fiftieth:50,sixtieth:60,seventieth:70,eightieth:80,ninetieth:90,twenty:20,thirty:30,forty:40,fourty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90},multiples:{hundredth:100,thousandth:1e3,millionth:1e6,billionth:1e9,trillionth:1e12,quadrillionth:1e15,quintillionth:1e18,sextillionth:1e21,septillionth:1e24,hundred:100,thousand:1e3,million:1e6,billion:1e9,trillion:1e12,quadrillion:1e15,quintillion:1e18,sextillion:1e21,septillion:1e24,grand:1e3}},o=function(e,t){if(a.ones.hasOwnProperty(e)){if(t.ones||t.teens)return!1}else if(a.teens.hasOwnProperty(e)){if(t.ones||t.teens||t.tens)return!1}else if(a.tens.hasOwnProperty(e)&&(t.ones||t.teens||t.tens))return!1;return!0},l=function(e){for(var t="0.",n=0;n<e.length;n++){var r=e[n];if(!0===a.ones.hasOwnProperty(r))t+=a.ones[r];else if(!0===a.teens.hasOwnProperty(r))t+=a.teens[r];else if(!0===a.tens.hasOwnProperty(r))t+=a.tens[r];else{if(!0!==/^[0-9]$/.test(r))return 0;t+=r}}return parseFloat(t)},s=function(e){return e=(e=(e=(e=(e=(e=(e=(e=e.replace(/1st$/,"1")).replace(/2nd$/,"2")).replace(/3rd$/,"3")).replace(/([4567890])r?th$/,"$1")).replace(/^[$€¥£¢]/,"")).replace(/[%$€¥£¢]$/,"")).replace(/,/g,"")).replace(/([0-9])([a-z\u00C0-\u00FF]{1,2})$/,"$1")},f=/^([0-9,\. ]+)\/([0-9,\. ]+)$/,h={"a couple":2,"a dozen":12,"two dozen":24,zero:0},c=function(e){return Object.keys(e).reduce((function(t,n){return t+=e[n]}),0)},p=function(e){if(!0===h.hasOwnProperty(e))return h[e];if("a"===e||"an"===e)return 1;for(var t=u(e),n=null,r={},i=0,p=!1,d=(e=t.str).split(/[ -]/),m=0;m<d.length;m++){var y=d[m];if((y=s(y))&&"and"!==y)if("-"!==y&&"negative"!==y){if("-"===y.charAt(0)&&(p=!0,y=y.substr(1)),"point"===y)return i+=c(r),i+=l(d.slice(m+1,d.length)),i*=t.amount;var v=y.match(f);if(v){var g=parseFloat(v[1].replace(/[, ]/g,"")),x=parseFloat(v[2].replace(/[, ]/g,""));x&&(i+=g/x||0)}else{if(!1===o(y,r))return null;if(/^[0-9\.]+$/.test(y))r.ones=parseFloat(y);else if(!0===a.ones.hasOwnProperty(y))r.ones=a.ones[y];else if(!0===a.teens.hasOwnProperty(y))r.teens=a.teens[y];else if(!0===a.tens.hasOwnProperty(y))r.tens=a.tens[y];else if(!0===a.multiples.hasOwnProperty(y)){var O=a.multiples[y];if(O===n)return null;if(100===O&&void 0!==d[m+1]){var b=d[m+1];a.multiples[b]&&(O*=a.multiples[b],m+=1)}null===n||O<n?(i+=(c(r)||1)*O,n=O,r={}):(n=O,i=((i+=c(r))||1)*O,r={})}}}else p=!0}return i+=c(r),i*=t.amount,0===(i*=p?-1:1)&&0===Object.keys(r).length?null:i},d=function(e){var t=e.text("reduced"),n=/[0-9],[0-9]/.test(e.text("text")),r=(t=t.replace(/,/g,"")).split(/^([^0-9]*)([0-9.,]*)([^0-9]*)$/);if(r&&r[2]&&e.terms().length<2){var i=parseFloat(r[2]||t);"number"!=typeof i&&(i=null);var u=r[3]||"";return"st"!==u&&"nd"!==u&&"rd"!==u&&"th"!==u||(u=""),"m"!==u&&"M"!==u||(i*=1e6,u=""),"k"!==u&&"k"!==u||(i*=1e3,u=""),{hasComma:n,prefix:r[1]||"",num:i,suffix:u}}return{hasComma:n,prefix:"",num:p(t),suffix:""}},m=function(e,t,n){if(!1!==e){var r=t.lookAhead("^(#Unit|#Noun)");r.has("(#Address|#Money|#Percent)")||t.has("#Ordinal")||(1===n.num?r.nouns().toSingular():r.has("#Singular")&&r.nouns().toPlural())}},y=function(e){return e<1e6?String(e):-1===(t="number"==typeof e?e.toFixed(0):e).indexOf("e+")?t:t.replace(".","").split("e+").reduce((function(e,t){return e+Array(t-e.length+2).join(0)}));var t},v=[["ninety",90],["eighty",80],["seventy",70],["sixty",60],["fifty",50],["forty",40],["thirty",30],["twenty",20]],g=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],x=[[1e24,"septillion"],[1e20,"hundred sextillion"],[1e21,"sextillion"],[1e20,"hundred quintillion"],[1e18,"quintillion"],[1e17,"hundred quadrillion"],[1e15,"quadrillion"],[1e14,"hundred trillion"],[1e12,"trillion"],[1e11,"hundred billion"],[1e9,"billion"],[1e8,"hundred million"],[1e6,"million"],[1e5,"hundred thousand"],[1e3,"thousand"],[100,"hundred"],[1,"one"]],O=function(e){var t=[];if(e>100)return t;for(var n=0;n<v.length;n++)e>=v[n][1]&&(e-=v[n][1],t.push(v[n][0]));return g[e]&&t.push(g[e]),t},b=function(e){if(0===e||"0"===e)return"zero";e>1e21&&(e=y(e));var t=[];e<0&&(t.push("minus"),e=Math.abs(e));for(var n=function(e){var t=e,n=[];return x.forEach((function(r){if(e>=r[0]){var i=Math.floor(t/r[0]);t-=i*r[0],i&&n.push({unit:r[1],count:i})}})),n}(e),r=0;r<n.length;r++){var i=n[r].unit;"one"===i&&(i="",t.length>1&&t.push("and")),(t=t.concat(O(n[r].count))).push(i)}return 0===(t=(t=t.concat(function(e){var t=["zero","one","two","three","four","five","six","seven","eight","nine"],n=[],r=y(e).match(/\.([0-9]+)/);if(!r||!r[0])return n;n.push("point");for(var i=r[0].split(""),u=0;u<i.length;u++)n.push(t[i[u]]);return n}(e))).filter((function(e){return e}))).length&&(t[0]=""),t.join(" ")},w=function(e){if(!e&&0!==e)return null;var t=e%100;if(t>10&&t<20)return String(e)+"th";var n={0:"th",1:"st",2:"nd",3:"rd"},r=y(e),i=r.slice(r.length-1,r.length);return r+=n[i]?n[i]:"th"},V={one:"first",two:"second",three:"third",five:"fifth",eight:"eighth",nine:"ninth",twelve:"twelfth",twenty:"twentieth",thirty:"thirtieth",forty:"fortieth",fourty:"fourtieth",fifty:"fiftieth",sixty:"sixtieth",seventy:"seventieth",eighty:"eightieth",ninety:"ninetieth"},C=function(e){var t=b(e).split(" "),n=t[t.length-1];return V.hasOwnProperty(n)?t[t.length-1]=V[n]:t[t.length-1]=n.replace(/y$/,"i")+"th",t.join(" ")},P={"¢":"cents",$:"dollars","£":"pounds","¥":"yen","€":"euros","₡":"colón","฿":"baht","₭":"kip","₩":"won","₹":"rupees","₽":"ruble","₺":"liras"},N={"%":"percent",s:"seconds",cm:"centimetres",km:"kilometres"},$={usd:!0,eur:!0,jpy:!0,gbp:!0,cad:!0,aud:!0,chf:!0,cny:!0,hkd:!0,nzd:!0,kr:!0,rub:!0},j=function(e){return P.hasOwnProperty(e.prefix)&&(e.suffix+=P[e.prefix],e.prefix=""),N.hasOwnProperty(e.suffix)&&(e.suffix=N[e.suffix]),$.hasOwnProperty(e.suffix)&&(e.suffix=e.suffix.toUpperCase()),e.suffix&&(e.suffix=" "+e.suffix),e},E=function(e,t,n){var r=String(e.num);return t?(e=j(e),n?(r=C(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||"")):(r=b(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||""))):n?(r=w(r),e=j(e),"".concat(e.prefix||"").concat(r).concat(e.suffix||"")):(!0===e.hasComma&&(r=e.num.toLocaleString()),r=y(r),"".concat(e.prefix||"").concat(r).concat(e.suffix||""))},M={json:function(e){var t=null;"number"==typeof e&&(t=e,e=null),e=e||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach((function(t){var r=t.json(e)[0],i=d(t);r.prefix=i.prefix,r.number=i.num,r.suffix=i.suffix,r.cardinal=E(i,!1,!1),r.ordinal=E(i,!1,!0),r.textCardinal=E(i,!0,!1),r.textOrdinal=E(i,!0,!0),n.push(r)})),null!==t?n[t]:n},units:function(){return this.lookAhead("^(#Unit|#Noun)")},isOrdinal:function(){return this.if("#Ordinal")},isCardinal:function(){return this.if("#Cardinal")},toNumber:function(){return this.forEach((function(e){var t=d(e);if(null!==t.num){var n=E(t,!1,e.has("#Ordinal"));e.replaceWith(n,!0),e.tag("NumericValue")}})),this},toLocaleString:function(){return this.forEach((function(e){var t=d(e);if(null!==t.num){t.num=t.num.toLocaleString();var n=E(t,!1,e.has("#Ordinal"));e.replaceWith(n,!0)}})),this},toText:function(){return this.forEach((function(e){var t=d(e);if(null!==t.num){var n=E(t,!0,e.has("#Ordinal"));e.replaceWith(n,!0),e.tag("TextValue")}})),this},toCardinal:function(e){return this.if("#Ordinal").forEach((function(t){var n=d(t);if(null!==n.num){var r=E(n,t.has("#TextValue"),!1);t.replaceWith(r,!0),t.tag("Cardinal"),m(e,t,n)}})),this},toOrdinal:function(){var e=this;return this.if("#Cardinal").forEach((function(t){var n=d(t);if(null!==n.num){var r=E(n,t.has("#TextValue"),!0);t.replaceWith(r,!0),t.tag("Ordinal");var i=e.lookAhead("^#Plural");i.found&&i.nouns().toSingular()}})),this},isEqual:function(e){return this.filter((function(t){return d(t).num===e}))},greaterThan:function(e){return this.filter((function(t){return d(t).num>e}))},lessThan:function(e){return this.filter((function(t){return d(t).num<e}))},between:function(e,t){return this.filter((function(n){var r=d(n).num;return r>e&&r<t}))},set:function(e,t){return void 0===e?this:("string"==typeof e&&(e=p(e)),this.forEach((function(n){var r=d(n);if(r.num=e,null!==r.num){var i=E(r,n.has("#TextValue"),n.has("#Ordinal"));n.replaceWith(i,!0),m(t,n,r)}})),this)},add:function(e,t){return e?("string"==typeof e&&(e=p(e)),this.forEach((function(n){var r=d(n);if(null!==r.num){r.num+=e;var i=E(r,n.has("#TextValue"),n.has("#Ordinal"));n.replaceWith(i,!0),m(t,n,r)}})),this):this},subtract:function(e,t){return this.add(-1*e,t)},increment:function(e){return this.add(1,e),this},decrement:function(e){return this.add(-1,e),this},fractions:function(e){var t=this.match("#Fraction");return"number"==typeof e&&(t=t.get(e)),t},romanNumerals:function(e){var t=this.match("#RomanNumeral").numbers();return"number"==typeof e&&(t=t.get(e)),t},money:function(e){var t=this.splitOn("@hasComma");return t=(t=t.match("#Money+ #Currency?")).numbers(),"number"==typeof e&&(t=t.get(e)),t}};M.toNice=M.toLocaleString,M.isBetween=M.between,M.minus=M.subtract,M.plus=M.add,M.equals=M.isEqual;var q=M,A=function(e){e.match("(hundred|thousand|million|billion|trillion|quadrillion|quintillion|sextillion|septillion)").tag("#Multiple"),e.match("the [/[0-9]+s$/]").tag("#Plural"),e.match("half a? #Value").tag("Value","half-a-value"),e.match("#Value and a (half|quarter)").tag("Value","value-and-a-half"),e.match("#Money and #Money #Currency?").tag("Money","money-and-money")},T={Fraction:{isA:"Value"},Multiple:{isA:"Value"}};return function(r,u){u.addTags(T),u.postProcess(A);var a=function(r){function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n(this,e(i).apply(this,arguments))}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(i,r),i}(r);return Object.assign(a.prototype,q),r.prototype.numbers=function(e){var t=i(this,e);return new a(t.list,this,this.world)},r.prototype.values=r.prototype.numbers,r}}));
